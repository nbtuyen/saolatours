<?phpclass Product_menuBModelsProduct_menu  extends FSModels{	function __construct() {	}	function getListCat() {		$fs_table = FSFactory::getClass ( 'fstable' );		$query = "SELECT name,alias,id,level,parent_id as parent_id,alias, list_parents,tablename,image,icon,show_in_homepage,show_in_footer						  FROM ".$fs_table->_('fs_products_categories')." AS a						  WHERE published = 1 						  ORDER BY ordering ASC, id ASC						  						 ";		global $db;		$db->query ( $query );		$category_list = $db->getObjectList ();				if (! $category_list)			return;		$tree_class = FSFactory::getClass ( 'tree', 'tree/' );		return $list = $tree_class->indentRows ( $category_list, 3 );		}	function getListCat2() {		$fs_table = FSFactory::getClass ( 'fstable' );		$query = "SELECT *						  FROM ".$fs_table->_('fs_products_categories')." AS a						  WHERE published = 1 AND show_in_homepage = 1						  ORDER BY ordering ASC LIMIT 4						  						 ";		global $db;		$db->query ( $query );		$category_list = $db->getObjectList ();				if (! $category_list)			return;				return $category_list;		}	function getListProduct() {		$fs_table = FSFactory::getClass ( 'fstable' );		$query = "SELECT *						  FROM ".$fs_table->_('fs_products')." AS a						  WHERE published = 1						  ORDER BY ordering ASC, id ASC						 ";		global $db;		$db->query ( $query );		$product_list = $db->getObjectList ();	}		/*	 * Lấy bộ lọc có tính count theo từng filter	 */	function get_filters_has_calculate($cat) {		$module = FSInput::get ( 'module' );		if ($module != 'products')			return;		$where = '';		$filter = FSInput::get ( 'filter' );		$count_filter = 0;		if ($filter) {			$arr_filter = explode ( ',', $filter );			//				$arr_standart_filter = array ();			for($i = 0; $i < count ( $arr_filter ); $i ++) {				$filter_item = $arr_filter [$i];				if ($filter_item) {					//						$arr_standart_filter [] = "'" . $filter_item . "'";					$where .= ' AND url_alias LIKE  ",%' . $filter_item . '%," ';					$count_filter ++;				}			}		}				$where .= ' AND url_total_params =  ' . $count_filter . ' ';		if ($cat->id) {			$where .= ' AND category_id = ' . $cat->id . ' ';		}		//			if($cat -> tablename){		//				$where .= ' AND tablename = "'.$cat->tablename.'" AND is_common <> 1'; 		//			} else {		//				$where .= '  AND is_common = 1'; 		//			}		$query = ' SELECT record_id,id, total, filter_show,field_name,field_show,alias, calculator,record_id						FROM '.$fs_table->_('fs_products_filters_values').' 						WHERE published = 1 ' . $where . '						GROUP BY record_id';		global $db;		$db->query ( $query );		return $result = $db->getObjectList ();	}		/*get filter follow tablename of products		 * 		 */	function get_filter_all() {		global $db;		$fs_table = FSFactory::getClass ( 'fstable' );		$query = " SELECT *						FROM ".$fs_table->_('fs_products_filters')."						WHERE published = 1						ORDER BY field_ordering ASC, ordering, is_common DESC						";		$db->query ( $query );		$result = $db->getObjectList ();		return $result;	}	function get_filters_home(){		$fs_table = FSFactory::getClass ( 'fstable' );		return $this -> get_records('published = 1 AND is_home = 1 ',$fs_table->_('fs_products_filters'),'*');	}}?>